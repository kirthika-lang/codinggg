<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Smart Lighting Identification System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Poppins', sans-serif;
}

body{
    background: linear-gradient(135deg,#1f2937,#111827);
    color:white;
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
}

header{
    width:100%;
    padding:20px;
    text-align:center;
    background:#111827;
    box-shadow:0 2px 10px rgba(0,0,0,0.4);
}

header h1{
    font-weight:600;
    font-size:26px;
}

.container{
    width:90%;
    max-width:900px;
    margin-top:40px;
    background:#1f2937;
    padding:30px;
    border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,0.5);
}

.upload-box{
    border:2px dashed #4b5563;
    padding:30px;
    text-align:center;
    border-radius:10px;
    cursor:pointer;
    transition:0.3s;
}

.upload-box:hover{
    border-color:#3b82f6;
}

input[type="file"]{
    display:none;
}

button{
    margin-top:20px;
    padding:12px 25px;
    border:none;
    border-radius:8px;
    background:#3b82f6;
    color:white;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:#2563eb;
}

#preview{
    margin-top:20px;
    text-align:center;
}

#preview img{
    max-width:250px;
    border-radius:10px;
    margin-top:10px;
}

.loader{
    margin-top:20px;
    display:none;
}

.loader div{
    width:40px;
    height:40px;
    border:5px solid #3b82f6;
    border-top:5px solid transparent;
    border-radius:50%;
    animation:spin 1s linear infinite;
    margin:auto;
}

@keyframes spin{
    100%{transform:rotate(360deg);}
}

.result{
    margin-top:30px;
    display:none;
}

.card{
    background:#111827;
    padding:20px;
    border-radius:10px;
    margin-top:15px;
}

.card img{
    max-width:200px;
    margin-top:10px;
    border-radius:8px;
}

.similar-section{
    margin-top:30px;
}

.similar-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
    gap:15px;
    margin-top:15px;
}

.similar-card{
    background:#111827;
    padding:15px;
    border-radius:8px;
}

.similar-card img{
    width:100%;
    border-radius:8px;
}
</style>
</head>

<body>

<header>
    <h1>ðŸ’¡ AI Smart Lighting Identification System</h1>
</header>

<div class="container">

    <label class="upload-box">
        Click to Upload Lighting Image
        <input type="file" id="imageInput" accept="image/*">
    </label>

    <div id="preview"></div>

    <button onclick="identifyProduct()">Identify Product</button>

    <div class="loader" id="loader">
        <div></div>
        <p>Analyzing Image...</p>
    </div>

    <div class="result" id="resultSection"></div>

</div>


<script src="app.js">
    
let selectedFile = null;

document.getElementById("imageInput").addEventListener("change", function(e){
    selectedFile = e.target.files[0];
    const reader = new FileReader();

    reader.onload = function(){
        document.getElementById("preview").innerHTML =
            `<h3>Preview:</h3>
             <img src="${reader.result}">`;
    }

    reader.readAsDataURL(selectedFile);
});

async function identifyProduct(){

    if(!selectedFile){
        alert("Please upload an image first!");
        return;
    }

    const formData = new FormData();
    formData.append("image", selectedFile);

    document.getElementById("loader").style.display="block";
    document.getElementById("resultSection").style.display="none";

    try{
        const response = await fetch("/upload", {
            method:"POST",
            body:formData
        });

        const data = await response.json();

        document.getElementById("loader").style.display="none";
        displayResult(data);

    }catch(error){
        alert("Error connecting to server");
        document.getElementById("loader").style.display="none";
    }
}

function displayResult(data){

    let resultHTML = "";

    if(data.match){

        resultHTML += `
        <div class="card">
            <h2>âœ… Best Match Found</h2>
            <p><strong>Item Number:</strong> ${data.match.item_number}</p>
            <p><strong>Lamp Type:</strong> ${data.match.lamp_type}</p>
            <p><strong>Dimensions:</strong> ${data.match.dimensions}</p>
            <p><strong>Finish:</strong> ${data.match.finish}</p>
            <p><strong>Material:</strong> ${data.match.material}</p>
            <p><strong>Price:</strong> ${data.match.price}</p>
            <p><strong>Similarity Score:</strong> ${(data.match.score * 100).toFixed(2)}%</p>
            <img src="${data.match.image_url}">
        </div>`;
    }

    if(data.similar && data.similar.length > 0){

        resultHTML += `
        <div class="similar-section">
            <h2>ðŸ”Ž Similar Products</h2>
            <div class="similar-grid">`;

        data.similar.forEach(product=>{
            resultHTML += `
                <div class="similar-card">
                    <img src="${product.image_url}">
                    <p><strong>${product.item_number}</strong></p>
                    <p>${product.lamp_type}</p>
                    <p>â‚¹ ${product.price}</p>
                </div>`;
        });

        resultHTML += `</div></div>`;
    }

    document.getElementById("resultSection").innerHTML = resultHTML;
    document.getElementById("resultSection").style.display="block";
}

</script>

</body>
</html>